<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Mennyei csal√°d ‚Äì √öt az √öjv√°rt√≥l a Szenth√°roms√°g t√©rig</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body {
    font-family: 'Georgia', serif;
    background: url('images/szentharomsag.jpg') center/cover no-repeat fixed;
    margin: 0;
    padding: 0;
    color: #f5f2e9;

    /* hogy a MapDock z√°rt √°llapotban se takarja a v√©g√©t */
    padding-bottom: calc(86px + env(safe-area-inset-bottom));
}

.container {
    max-width: 800px;
    margin: auto;
    background: rgba(0,0,0,0.55);
    padding: 30px 22px 40px 22px;
    border-radius: 14px;
    margin-top: 24px;
    margin-bottom: 24px;
    box-shadow: 0 0 25px rgba(0,0,0,0.7);
}

h1 {
    text-align: center;
    color: #ffe7a3;
    margin-bottom: 18px;
}

h2 {
    margin-top: 30px;
    margin-bottom: 10px;
    color: #ffe7a3;
}

p {
    line-height: 1.7;
    font-size: 18px;
    margin-bottom: 14px;
}

/* K√©pek */
.section-image {
    display: block;
    max-width: 100%;
    border-radius: 10px;
    margin: 14px auto 18px auto;
    box-shadow: 0 0 16px rgba(0,0,0,0.6);
}

/* Navig√°ci√≥s gombok ‚Äì √âGSZ√çNK√âK */
.navbtn {
    display:inline-block;
    margin: 8px 0 6px 0;
    padding: 8px 14px;
    background:#68c7ff;
    color:#033048;
    font-weight:bold;
    font-size:14px;
    border-radius:7px;
    text-decoration:none;
    box-shadow:0 0 8px rgba(0,0,0,0.4);
}

/* hogy buttonk√©nt is ugyan√∫gy n√©zzen ki */
button.navbtn{
    border:none;
    cursor:pointer;
    font-family: inherit;
}

/* T√°vols√°g doboz minden ponthoz */
.distance-box {
    margin: 4px 0 16px 0;
    padding: 10px 12px;
    border-radius: 8px;
    background: rgba(0,0,0,0.45);
    font-size: 15px;
}
.distance-box button {
    font-family: inherit;
    font-size: 15px;
    padding: 6px 12px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: #ffe7a3;
    color: #2b1b0c;
    margin-bottom: 4px;
}
.distance-box button:active {
    transform: scale(0.98);
}
.distance-status {
    display: block;
    margin-top: 2px;
    font-size: 14px;
}

/* F≈ëoldal gomb */
.home {
    display:inline-block;
    margin-top:25px;
    padding:12px 22px;
    background:#ffe7a3;
    color:#333;
    font-weight:bold;
    border-radius:8px;
    text-decoration:none;
    box-shadow:0 0 12px rgba(0,0,0,0.6);
    font-size:17px;
}

/* Mobil finomhangol√°s */
@media (max-width: 480px) {
    .container {
        margin-top: 15px;
        margin-bottom: 15px;
        padding: 22px 16px 30px 16px;
    }
    p { font-size: 17px; }
    h1 { font-size: 25px; }
}

/* ===== MAP DOCK (Toszk√°n st√≠lus) ===== */
.map-dock{
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 999;
    height: 520px;
    padding-bottom: env(safe-area-inset-bottom);

    transform: translateY(calc(100% - 56px));
    transition: transform 220ms ease;

    background: transparent;
    border-top: 0;
    box-shadow: none;
}

.map-dock.open{
    transform: translateY(0);
}

/* k√∂z√©pre tett panel h√°tt√©r */
.map-dock::before{
    content:"";
    position:absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 0;
    bottom: 0;

    width: min(800px, calc(100% - 28px));
    background: rgba(0,0,0,0.78);
    border-top: 1px solid rgba(255,255,255,0.12);
    border-top-left-radius: 14px;
    border-top-right-radius: 14px;
    box-shadow: 0 -8px 24px rgba(0,0,0,0.35);

    pointer-events: none;
}

/* handle + body */
.map-dock-handle,
.map-dock-body{
    position: relative;
    z-index: 1;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
}

.map-dock-handle{
    height: 56px;
    display:flex;
    align-items:center;
    justify-content: space-between;
    padding: 0 14px;

    user-select: none;

    /* csak a gomb kattinthat√≥ */
    pointer-events: none;
}

.map-dock-title{
    font-weight: 800;
    color: #f5f2e9;
    pointer-events: none;
}

.map-dock-btn{
    appearance: none;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.08);
    color: #f5f2e9;
    border-radius: 12px;
    padding: 8px 10px;
    font-weight: 800;
    cursor: pointer;

    pointer-events: auto; /* csak ez kap clicket */
}

.map-dock-body{
    height: calc(520px - 56px);
    padding: 0 14px 14px 14px;
}

#map{
    width: 100%;
    height: 100%;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.10);
    box-shadow: 0 10px 22px rgba(0,0,0,0.30);
    overflow: hidden;
}
</style>
</head>

<body>

<div class="container">

<h1>6. Mennyei csal√°d ‚Äì √öt az √öjv√°rt√≥l a Szenth√°roms√°g t√©rig</h1>

<p>Miut√°n magatok m√∂g√∂tt hagyj√°tok az √öjv√°r feh√©r falait, lefel√© indultok a temet≈ë √©s a parkol√≥ mellett. A hegyoldal lassan kiny√≠lik, a h√°zak s≈±r≈±s√∂dnek, √©s l√©p√©sr≈ël l√©p√©sre k√∂zelebb ker√ºlt√∂k Selmecb√°nya igazi sz√≠v√©hez. Ez az √∫t nem csak egy s√©ta a v√°rb√≥l a f≈ët√©r fel√©, hanem mintha egy id≈ëvonalon haladn√°tok v√©gig: er≈ëdb≈ël kapun √°t a b√°ny√°szok hajnal√°ba, onnan a v√°ros tan√°csaihoz, a polg√°rok templom√°hoz, v√©g√ºl a szerelem √©s a Szenth√°roms√°g k√∂zponti ter√©ig.</p>

<h2>K√°lv√°ria ‚Äì a v√°ros f√∂l√∂tt ≈ërk√∂d≈ë hegy</h2>
<img src="images/Kalvaria.jpg" alt="Selmecb√°nya K√°lv√°ria" class="section-image">
<p>Miel≈ëtt lejjebb l√©pn√©tek, √©rdemes egy pillanatra meg√°llni √©s feln√©zni a t√°volban magasod√≥ <strong>K√°lv√°ri√°ra</strong>. A hegy oldal√°ban h√°rom templom √©s k√°poln√°k sora kapaszkodik felfel√©, mint egy hossz√∫ im√°ds√°g, amely a v√°ros f√∂l√∂tt lebeg. A 18. sz√°zad k√∂zep√©n √©p√ºlt, √©s a t√©rs√©g egyik legjelent≈ësebb barokk k√°lv√°ri√°jak√©nt tartj√°k sz√°mon.</p>
<p>A st√°ci√≥k Krisztus szenved√©st√∂rt√©net√©t j√°rj√°k v√©gig, mik√∂zben a zar√°ndok egyre magasabbr√≥l n√©z vissza a kr√°ter alak√∫ hegykoszor√∫ √∂lel√©s√©ben fekv≈ë v√°rosra. Innen, lentr≈ël n√©zve is √©rteni lehet, mi√©rt gondolt√°k az egykori b√°ny√°szok √∫gy, hogy Selmecb√°ny√°t nem csak er≈ëd√∂k, hanem im√°ds√°gok is v√©dik.</p>

<h2>V√°roskapu ‚Äì a r√©gi ≈ërhely</h2>
<img src="images/varoskapu.jpg" alt="V√°roskapu Selmecb√°ny√°n" class="section-image">

<a href="https://maps.app.goo.gl/U4uNewB8FCkMtWG28" target="_blank" class="navbtn">üìç Navig√°ci√≥ a v√°roskapuhoz</a>
<button type="button" class="navbtn" onclick="showOnMap('gate')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="gateBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="gateText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<p>Ahogy lejjebb √©rtek a hegyr≈ël, egy r√©gi kapu maradv√°nya fogad: ez a <strong>v√°roskapu</strong>, Selmecb√°nya egykori falrendszer√©nek fontos r√©sze. A 16. sz√°zadban er≈ës√≠tett√©k meg, amikor a t√∂r√∂k t√°mad√°sok egyre nagyobb fenyeget√©st jelentettek, √©s a b√°nyav√°rost k≈ëb≈ël rakott pajzsk√©nt vett√©k k√∂r√ºl a falak.</p>
<p>A kapun √°t haladtak be a teherrel √©rkez≈ë szekerek, a keresked≈ëk, a di√°kok √©s a b√°ny√°szfalvakb√≥l √©rkez≈ë munk√°sok. Ma m√°r ink√°bb csak eml√©keztet arra, hogy aki itt bel√©p, nem egy √°tlagos kisv√°ros utc√°ira √©rkezik, hanem egy olyan helyre, ahol az arany √©s ez√ºst egyszer eg√©sz Eur√≥pa t√∂rt√©net√©t mozgatta.</p>

<h2>Kopogtat√≥ h√°z ‚Äì Klopaƒçka, a b√°ny√°szok √©breszt≈ë√≥r√°ja</h2>
<img src="images/Klopacska.jpg" alt="Klopacska, a Kopogtat√≥ H√°z" class="section-image">

<a href="https://maps.app.goo.gl/6QeHAt8cPnbpb4Ed6" target="_blank" class="navbtn">üìç Navig√°ci√≥ a Klopaƒçk√°hoz</a>
<button type="button" class="navbtn" onclick="showOnMap('klop')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="klopBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="klopText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<p>Tov√°bb s√©t√°lva el√©ritek a <strong>Kopogtat√≥ h√°zat</strong>, vagy ahogy a helyiek emlegetik, a Klopaƒçka tornyot. Els≈ë pillant√°sra kedves, r√©gi h√°z, ma te√°z√≥, de a m√∫ltja sokkal kem√©nyebb: itt sz√≥ szerint ‚Äûlekopogt√°k‚Äù a b√°ny√°szok napj√°t.</p>
<p>A 17. sz√°zadban a fels≈ë szinten egy nagy f√°b√≥l k√©sz√ºlt kopogtat√≥szerkezet m≈±k√∂d√∂tt. Hajnal el≈ëtt, nagyj√°b√≥l f√©l h√°rom k√∂r√ºl jellegzetes kopog√°s jelezte, hogy indul a m≈±szak, ideje lemenni a f√∂ld al√°. M√°s ritmusok k√ºl√∂n figyelmeztet√©seket jelentettek: t≈±zv√©sz, b√°nyaszerencs√©tlens√©g, ellens√©ges vesz√©ly vagy temet√©s. A b√°ny√°szok √©lete sz√≥ szerint ehhez a hanghoz igazodott.</p>
<p>Kevesen tudj√°k, hogy az als√≥ szinten valaha a rendbont√≥ b√°ny√°szok ‚Äûmini b√∂rt√∂ne‚Äù is volt. Ma m√°r csak a cs√©sze tea koppan a cs√©szealjon, de ha csendben figyeltek, szinte hallani lehet a r√©gi kopogtat√°s visszhangj√°t a falakban.</p>

<h2>V√°rosh√°za √©s az √≥ra k√ºl√∂n√∂s titka</h2>
<img src="images/varoshaza1.jpg" alt="Selmecb√°nya V√°rosh√°za" class="section-image">

<a href="https://maps.app.goo.gl/dJjbyZMbzzJGRths9" target="_blank" class="navbtn">üìç Navig√°ci√≥ a V√°rosh√°z√°hoz</a>
<button type="button" class="navbtn" onclick="showOnMap('varoshaza')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="varoshazaBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="varoshazaText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<p>A s√©ta k√∂vetkez≈ë √°llom√°sa a <strong>V√°rosh√°za</strong>. Az √©p√ºlet k√∂z√©pkori magja a 14. sz√°zadig ny√∫lik vissza, mai barokk form√°j√°t a 18. sz√°zadi √°t√©p√≠t√©sek sor√°n nyerte el. Falai k√∂z√∂tt √©vsz√°zadokon √°t itt hozt√°k a d√∂nt√©seket b√°nyajogr√≥l, kereskedelemr≈ël, ad√≥kr√≥l √©s a v√°ros mindennapi √©let√©r≈ël.</p>
<p>A legt√∂bb l√°togat√≥nak azonban azonnal az t≈±nik fel, hogy a torony √≥r√°ja ‚Äûfurcs√°n‚Äù m≈±k√∂dik: <strong>a nagy mutat√≥ az √≥r√°t, a kicsi a perceket mutatja</strong>. Egy magyar√°zat szerint a hegyoldalr√≥l, messzir≈ël n√©z≈ë b√°ny√°szok √©s polg√°rok sz√°m√°ra az volt a l√©nyeg, hogy nagy vonalakban tudj√°k, h√°ny √≥ra van, a percek csak m√°sodlagosak voltak ‚Äì ez√©rt lett nagyobb az √≥ramutat√≥.</p>
<p>Egy m√°sik, j√°t√©kosabb legenda √∫gy tartja, hogy a v√°rosba √©rkez≈ë keresked≈ëket akart√°k ezzel kiss√© megtr√©f√°lni, akik nem lelkesedtek a k√∂lts√©gek √°ll√°s√°√©rt. Ha igaz, ha nem, a t√∂rt√©net j√≥l illik Selmecb√°ny√°hoz: itt az id≈ët is kicsit m√°sk√©pp m√©rt√©k, mint m√°shol.</p>

<h2>Szent Katalin templom ‚Äì a polg√°rok temploma</h2>
<img src="images/stkatalin.jpg" alt="Szent Katalin templom" class="section-image">

<a href="https://maps.app.goo.gl/1yGmxVYssquJUeRy7" target="_blank" class="navbtn">üìç Navig√°ci√≥ a Szent Katalin templomhoz</a>
<button type="button" class="navbtn" onclick="showOnMap('katalin')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="katalinBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="katalinText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<section class="poi-block" id="poi-szent-katalin">
  <h2>Selmecb√°nya, Szent Katalin templom</h2>

  <p>
    A V√°rosh√°za mellett emelkedik Selmecb√°nya k√©s≈ë g√≥tikus Szent Katalin temploma, a 15. sz√°zad v√©g√©nek v√°rosi ‚Äûpolg√°rtemplom‚Äù hangulat√°val.
    A leg√©rdekesebb benne nem csak a forma, hanem a szerepe is: a 17. sz√°zadt√≥l a v√°ros ‚Äûnem n√©met‚Äù ajk√∫ lakoss√°ga, szlov√°kok √©s magyarok is itt tal√°lt lelki otthonra,
    ez√©rt sokan a polg√°rok templom√°nak nevezt√©k.
  </p>

  <h3>Mi√©rt k√ºl√∂nleges, mi a furcsa benne</h3>
  <ul>
    <li>
      <strong>Nyelv √©s identit√°s lenyomata</strong>
      A templom nem csup√°n vall√°si hely, hanem egy r√©gi v√°rosi t√∂r√©svonal ‚Äût√©rk√©pe‚Äù is, ki hol, milyen nyelven, milyen k√∂z√∂ss√©gben tal√°lt helyet mag√°nak.
    </li>
    <li>
      <strong>V√©d≈ëszent, aki ‚Äûnem illik‚Äù a b√°ny√°szv√°ros klis√©j√©hez</strong>
      Alexandriai Szent Katalin a hagyom√°ny szerint m≈±velt, b√°tor fiatal n≈ë volt, aki a cs√°sz√°ri udvar filoz√≥fusaival vit√°zott,
      √©s hite mellett kitartva m√°rt√≠rhal√°lt szenvedett. Egy b√°ny√°szv√°rosban ez els≈ëre meglep≈ë v√°laszt√°s.
    </li>
    <li>
      <strong>Mi√©rt pont ≈ë</strong>
      A b√°ny√°szok, di√°kok √©s tan√≠t√≥k sz√°m√°ra Katalin a b√∂lcsess√©get √©s a lelki szil√°rds√°got jelentette.
      Selmecb√°ny√°n a b√°ny√°szat m√∂g√∂tt mindig ott volt a tudom√°ny √©s az akad√©miai szellem, √≠gy a ‚Äûtud√°s szentje‚Äù nagyon is logikus, m√©gis szokatlanul besz√©des patr√≥nus.
    </li>
    <li>
      <strong>Helye a v√°ros sz√≠v√©ben</strong>
      Az, hogy k√∂zvetlen√ºl a V√°rosh√°za mellett √°ll, sz√©pen √∂sszek√∂ti a v√°rosi √©let k√©t p√≥lus√°t, a mindennapi d√∂nt√©seket √©s a lelki kapaszkod√≥t.
      Ritka, amikor ez ennyire egy helyre s≈±r≈±s√∂dik.
    </li>
  </ul>

  <p>
    <strong>T√∫raterv megjegyz√©s:</strong>
    Ez egy r√∂vid meg√°ll√≥s pont, k√≠v√ºlr≈ël is er≈ës, de igaz√°n akkor m≈±k√∂dik, ha p√°r percet hagysz arra, hogy ‚Äû√∂ssze√°lljon‚Äù a k√©p,
    hogyan lett egy b√°ny√°szv√°ros jelk√©p√©v√© egy vit√°z√≥, tud√≥s n≈ë szentje.
  </p>
</section>


<h2>Love Bank ‚Äì a szerelem trezorja</h2>
<img src="images/lovebank.jpg" alt="Love Bank Selmecb√°ny√°n" class="section-image">

<a href="https://maps.app.goo.gl/gtjbmpRjASEMawku5" target="_blank" class="navbtn">üìç Navig√°ci√≥ a Love Bankhoz</a>
<button type="button" class="navbtn" onclick="showOnMap('love')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="loveBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="loveText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<p>Ahogy tov√°bbmentek, el√©rkeztek a <strong>Love Bankhoz</strong>, a Mar√≠na h√°zhoz. Ez egy k√ºl√∂nleges, modern m√∫zeum, amely Andrej Sl√°dkoviƒç <em>‚ÄûMar√≠na‚Äù</em> c√≠m≈± vers√©re √©p√ºl, amelyet a vil√°g leghosszabb szerelmes vers√©nek tartanak.</p>

<style>
  .poi-image {
    width: 100%;
    margin: 16px 0;
    border-radius: 12px;
  }

  figure.poi-image {
    margin: 16px 0;
  }

  figure.poi-image img {
    width: 100%;
    border-radius: 12px;
    display: block;
  }

  figure.poi-image figcaption {
    font-size: 0.85em;
    opacity: 0.75;
    margin-top: 6px;
    text-align: center;
  }
</style>


<p>A Love Bank l√©nyege a <strong>Szerelem trezorja</strong>. A vers minden bet≈±j√©hez, sz√≥k√∂z√©hez √©s √≠r√°sjel√©hez tartozik egy kicsi ‚ÄûLove Box‚Äù ‚Äì apr√≥ trezor, amelyet p√°rok, csal√°dok, bar√°tok v√°laszthatnak maguknak. Ezekben a kis rekeszekben saj√°t eml√©keiket, leveleiket, apr√≥ t√°rgyaikat t√°rolhatj√°k ak√°r √©vtizedekre. Mintha egy b√°nyav√°rosban nem csak dr√°gak√∂veket, hanem √©rzelmeket is el lehetne rakt√°rozni a j√∂v≈ënek.</p>

<img src="images/lovebank2.jpg" alt="Selmecb√°nya ‚Äì Szent Katalin templom k√∂rnyezete" class="poi-image">


<p>A h√°z alatti pinc√©b≈ël egykor b√°nyaj√°ratok vezettek tov√°bb a f√∂ld al√°, ak√°rcsak n√©h√°ny szomsz√©dos √©p√ºlet al√≥l. N√©h√°ny √©ve t≈±zv√©sz √©rte az √©p√ºletet, de a Love Bank legfontosabb r√©sze, a szerelem trezorja megmaradt ‚Äì a helyiek szerint ez is bizony√≠tja, hogy vannak dolgok, amelyek er≈ësebbek a l√°ngokn√°l.</p>

<h2>Szenth√°roms√°g t√©r ‚Äì palot√°k √©s legend√°k</h2>
<img src="images/szentharomsag.jpg" alt="Szenth√°roms√°g t√©r Selmecb√°ny√°n" class="section-image">

<a href="https://maps.app.goo.gl/Bme5Li1qL3eZKQkN9" target="_blank" class="navbtn">üìç Navig√°ci√≥ a Szenth√°roms√°g t√©rre</a>
<button type="button" class="navbtn" onclick="showOnMap('ter')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="terBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="terText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<p>V√©g√ºl meg√©rkeztek Selmecb√°nya sz√≠v√©be, a <strong>Szenth√°roms√°g t√©rre</strong>. A 16. sz√°zad √≥ta ez a v√°ros f≈ë tere, ahol a leggazdagabb b√°nyav√°llalkoz√≥ csal√°dok palot√°i sorakoznak egym√°s mellett. A renesz√°nsz √©s barokk homlokzatok m√∂g√∂tt egykori jogi vit√°k, b√°nyat√°rsas√°gi szerz≈ëd√©sek √©s persze kisebb-nagyobb csal√°di t√∂rt√©netek lapulnak.</p>
<p>A t√©r k√∂zep√©n √°ll a barokk <strong>Szenth√°roms√°g-szobor</strong>, pestisoszlopk√©nt emelt fogadalmi eml√©k. Az 1710 k√∂r√ºli j√°rv√°ny ut√°n fogadt√°k meg a v√°ros lak√≥i, hogy ha t√∫l√©lik a puszt√≠t√°st, h√°l√°juk jel√©√ºl monument√°lis eml√©ket √°ll√≠tanak. A gazdagon faragott oszlop szentjei, angyalai √©s felh≈ëi √∫gy t√∂rnek az √©g fel√©, mintha maga a v√°ros im√°ds√°ga merevedett volna k≈ëv√©.</p>

<img src="images/Rubigall.jpg" alt="Rubigall-h√°z Selmecb√°ny√°n" class="section-image">

<a href="https://www.google.com/maps?q=48.45945599002962,18.892410972067733" target="_blank" class="navbtn">üìç Navig√°ci√≥ a Rubigall-h√°zhoz</a>
<button type="button" class="navbtn" onclick="showOnMap('rubigall')">üó∫Ô∏è Mutasd a t√©rk√©pen</button>

<div class="distance-box">
    <button id="rubigallBtn">T√°vols√°g m√©r√©se (GPS)</button>
    <span id="rubigallText" class="distance-status">
        Enged√©lyezd a helymeghat√°roz√°st a b√∂ng√©sz≈ëben.
    </span>
</div>

<p>A t√©ren √°ll√≥ palot√°k k√∂z√∂tt tal√°ljuk a gazdag b√°ny√°szcsal√°dok egykori h√°zait is. Az egyik ilyen h√°z ‚Äì a hagyom√°ny szerint ‚Äì a <strong>Rubigall csal√°dhoz</strong> k√∂thet≈ë, akikr≈ël egy 16. sz√°zadi t√∂rt√©net besz√©l. Eszerint <strong>Balassi B√°lint</strong>, a magyar renesz√°nsz k√∂lt≈ë egy k√∂zeli f√ºrd≈ëben cs√∫ny√°n √∂sszesz√≥lalkozott egy fiatal b√°nyav√°llalkoz√≥ fi√°val. A vita annyira elfajult, hogy Balassi k√©zzel int√©zte el az √ºgyet, majd levelet √≠rt az orsz√°ggy≈±l√©snek, hogy megv√©dje becs√ºlet√©t √©s elmagyar√°zza, mi vezetett a botr√°nyhoz.</p>
<p>K√©s≈ëbbi rosszm√°j√∫ mendemond√°k arr√≥l is suttogtak, hogy Balassi egy f√©rjes asszonnyal is bonyolult t√∂rt√©netbe keveredett, √©s a pletyk√°k messze tov√°bb gy≈±r≈±ztek a Felvid√©ken. Ezeket m√°r neh√©z pontosan igazolni, de j√≥l illenek egy olyan t√©rhez, ahol a gazdags√°g, a h√≠rn√©v √©s az emberi szenved√©lyek folyamatosan egym√°snak fesz√ºltek. T√∂bb h√°z alatt eredeti t√°r√≥k √©s b√°nyaj√°ratok ny√≠ltak, a t√©r √≠gy val√≥j√°ban egy f√∂ld alatti labirintus tetej√©n √°ll.</p>
<p>√âs ezzel el√©rt√©tek a k√∂vetkez≈ë √°llom√°st: a Szenth√°roms√°g teret. Innen indul tov√°bb a kincskeres√©s, a v√°ros k√∂vei √©s t√∂rt√©netei k√∂z√∂tt.</p>

<h2>Tal√°l√≥s k√©rd√©s a 7. ponthoz</h2>

<p>
Sokat √≠rtam, de sosem g√©pen,<br>
Lovon j√°rtam, jegy se k√©ne.<br>
Ha elszavalom a Nemzeti dalt,<br>
Minden magyar talpra √°ll.
</p>

<p>
Ennek a fick√≥nak a neve a kulcs<br>
a 7. ‚ÄûA k√∂lt≈ë nyom√°ban‚Äù ponthoz.
</p>

<div style="text-align:center;">
    <a href="index.html" class="home">‚¨Ö Vissza a F≈ëoldalra</a>
</div>

</div>

<!-- ===== MAP DOCK a lap alj√°n (ez kell) ===== -->
<div class="map-dock" id="mapDock">
  <div class="map-dock-handle" id="mapDockHandle">
    <div class="map-dock-title">üó∫Ô∏è T√©rk√©p</div>
    <button class="map-dock-btn" id="mapDockToggle" type="button" aria-expanded="false">‚ñ≤</button>
  </div>
  <div class="map-dock-body">
    <div id="map"></div>
  </div>
</div>

<script>
/* ===== T√°vols√°gm√©r√©s (a te megl√©v≈ë k√≥dod) ===== */

// Haversine t√°vols√°g m√©terben
function distanceMeters(lat1, lon1, lat2, lon2) {
    const R = 6371000;
    const toRad = x => x * Math.PI / 180;
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    const a =
        Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
        Math.sin(dLon / 2) * Math.sin(dLon / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
}

function formatDistance(m) {
    if (m < 5) return "Nagyj√°b√≥l a helysz√≠nen vagytok.";
    if (m < 1000) return m.toFixed(0) + " m√©ter";
    return (m / 1000).toFixed(2) + " km";
}

function setupDistance(buttonId, textId, targetLat, targetLon, label) {
    const btn = document.getElementById(buttonId);
    const text = document.getElementById(textId);

    btn.addEventListener("click", function () {
        if (!("geolocation" in navigator)) {
            text.textContent = "A b√∂ng√©sz≈ë nem t√°mogatja a helymeghat√°roz√°st.";
            return;
        }

        text.textContent = "Helyzet lek√©r√©se...";

        navigator.geolocation.getCurrentPosition(function (pos) {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            const dist = distanceMeters(lat, lon, targetLat, targetLon);
            text.textContent =
                "Jelenlegi t√°vols√°g " + label + ": " + formatDistance(dist);
        }, function () {
            text.textContent =
                "Nem siker√ºlt lek√©rni a helyzetet. Ellen≈ërizd a GPS √©s a jogosults√°g be√°ll√≠t√°sait.";
        }, {
            enableHighAccuracy: true,
            maximumAge: 5000,
            timeout: 10000
        });
    });
}

// v√°roskapu
setupDistance("gateBtn", "gateText",
    48.45549688232658, 18.893265659934563, "a v√°roskaput√≥l");

// Kopogtat√≥ h√°z
setupDistance("klopBtn", "klopText",
    48.457847427648865, 18.892376042636386, "a Kopogtat√≥ h√°zt√≥l");

// V√°rosh√°za
setupDistance("varoshazaBtn", "varoshazaText",
    48.45873011462128, 18.892658925899386, "a V√°rosh√°z√°t√≥l");

// Szent Katalin templom
setupDistance("katalinBtn", "katalinText",
    48.458785335534856, 18.893082302353815, "a Szent Katalin templomt√≥l");

// Love Bank
setupDistance("loveBtn", "loveText",
    48.45894872807427, 18.8930927183641, "a Love Bankt√≥l");

// Szenth√°roms√°g t√©r
setupDistance("terBtn", "terText",
    48.459546424238596, 18.89254506246573, "a Szenth√°roms√°g t√©rt≈ël");

// Rubigall-h√°z
setupDistance("rubigallBtn", "rubigallText",
    48.45945599002962, 18.892410972067733, "a Rubigall-h√°zt√≥l");


/* ===== MapDock + Leaflet (piros = saj√°t hely, k√©k = kiv√°lasztott) ===== */

const DAY_ID = "selmec-06";
const DOCK_KEY = "mapDockOpen_" + DAY_ID;

const POIS = [
  { id: "uivar",     n: 1,  name: "√öjv√°r",                 lat: 48.459319547021025, lon: 18.89161814188512 },
  { id: "gate",      n: 2,  name: "V√°roskapu",             lat: 48.45549688232658,  lon: 18.893265659934563 },
  { id: "klop",      n: 3,  name: "Kopogtat√≥ h√°z",         lat: 48.457847427648865, lon: 18.892376042636386 },
  { id: "varoshaza", n: 4,  name: "V√°rosh√°za",             lat: 48.45873011462128,  lon: 18.892658925899386 },
  { id: "katalin",   n: 5,  name: "Szent Katalin templom", lat: 48.458785335534856, lon: 18.893082302353815 },
  { id: "love",      n: 6,  name: "Love Bank",             lat: 48.45894872807427,  lon: 18.8930927183641 },
  { id: "ter",       n: 7,  name: "Szenth√°roms√°g t√©r",     lat: 48.459546424238596, lon: 18.89254506246573 },
  { id: "rubigall",  n: 8,  name: "Rubigall-h√°z",          lat: 48.45945599002962,  lon: 18.892410972067733 }
];

function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#39;");
}

let map = null;
let userMarker = null;   // PIROS (saj√°t hely)
let targetMarker = null; // K√âK (kiv√°lasztott)
let poiMarkers = new Map();

let userIconRed = null;
let poiIconGreen = null;
let targetIconBlue = null;

let __invalidateTimer = null;
function invalidateMapBurst(){
  if(!map) return;
  const fire = (ms) => setTimeout(() => { try{ map.invalidateSize(); } catch(e){} }, ms);
  fire(0); fire(120); fire(260); fire(520);
  if(__invalidateTimer) clearTimeout(__invalidateTimer);
  __invalidateTimer = setTimeout(() => { try{ map.invalidateSize(); } catch(e){} }, 900);
}

function initIcons(){
  if(!window.L) return;

  userIconRed = L.icon({
    iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",
    shadowUrl: "https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",
    iconSize: [25,41],
    iconAnchor: [12,41]
  });

  // ‚Äúalap‚Äù POI marker (z√∂ld, hogy a kiv√°lasztott k√©k l√°tsz√≥djon)
  poiIconGreen = L.icon({
    iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png",
    shadowUrl: "https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",
    iconSize: [25,41],
    iconAnchor: [12,41]
  });

  // Kiv√°lasztott marker (k√©k)
  targetIconBlue = L.icon({
    iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",
    shadowUrl: "https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",
    iconSize: [25,41],
    iconAnchor: [12,41]
  });
}

function initMap(){
  const el = document.getElementById("map");
  if(!el || !window.L) return;
  if(map) return;

  initIcons();

  map = L.map("map", { doubleClickZoom: true });
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { maxZoom: 19 }).addTo(map);

  const bounds = [];

  // POI markerek
  for(const p of POIS){
    const title = `${p.n}. ${p.name}`;
    const m = L.marker([p.lat, p.lon], { icon: poiIconGreen }).addTo(map);
    m.bindPopup(`<b>${escapeHtml(title)}</b>`);
    m.on("click", () => selectPoi(p.id, true));
    poiMarkers.set(p.id, m);
    bounds.push([p.lat, p.lon]);
  }

  // Kiv√°lasztott (k√©k) marker
  targetMarker = L.marker([POIS[0].lat, POIS[0].lon], { icon: targetIconBlue }).addTo(map);

  // Saj√°t hely (piros) marker
  userMarker = L.marker([POIS[0].lat, POIS[0].lon], { icon: userIconRed }).addTo(map);
  userMarker.bindPopup("Itt vagyok");

  if(bounds.length){
    map.fitBounds(bounds, { padding: [28, 28] });
  } else {
    map.setView([48.4587, 18.8938], 15);
  }

  // stabil m√©retez√©s
  if(typeof ResizeObserver !== "undefined"){
    try{
      const ro = new ResizeObserver(() => invalidateMapBurst());
      ro.observe(el);
    } catch(e){}
  }

  window.addEventListener("load", () => invalidateMapBurst());
  invalidateMapBurst();

  // folyamatos GPS friss√≠t√©s
  startWatchPosition();
}

function startWatchPosition(){
  if(!("geolocation" in navigator)) return;

  try{
    navigator.geolocation.watchPosition(
      (pos) => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        if(userMarker) userMarker.setLatLng([lat, lon]);
      },
      () => { /* csendben */ },
      { enableHighAccuracy: true, maximumAge: 5000, timeout: 15000 }
    );
  } catch(e){
    /* ignore */
  }
}

function openDock(){
  const dock = document.getElementById("mapDock");
  const btn = document.getElementById("mapDockToggle");
  if(!dock) return;

  dock.classList.add("open");
  if(btn){
    btn.textContent = "‚ñº";
    btn.setAttribute("aria-expanded", "true");
  }
  try{ localStorage.setItem(DOCK_KEY, "1"); } catch(e){}
  invalidateMapBurst();
}

function closeDock(){
  const dock = document.getElementById("mapDock");
  const btn = document.getElementById("mapDockToggle");
  if(!dock) return;

  dock.classList.remove("open");
  if(btn){
    btn.textContent = "‚ñ≤";
    btn.setAttribute("aria-expanded", "false");
  }
  try{ localStorage.setItem(DOCK_KEY, "0"); } catch(e){}
  invalidateMapBurst();
}

function toggleDock(){
  const dock = document.getElementById("mapDock");
  if(!dock) return;
  if(dock.classList.contains("open")) closeDock();
  else openDock();
}

function initMapDock(){
  const dock = document.getElementById("mapDock");
  const btn = document.getElementById("mapDockToggle");
  if(!dock || !btn) return;

  // alap√©rtelmez√©s: desktopon nyitva, mobilon z√°rva
  let isOpen = window.matchMedia("(min-width: 900px)").matches;

  try{
    const raw = localStorage.getItem(DOCK_KEY);
    if(raw === "1") isOpen = true;
    if(raw === "0") isOpen = false;
  } catch(e){}

  if(isOpen) openDock();
  else closeDock();

  // csak a ny√≠l gomb kattinthat√≥
  btn.addEventListener("click", (e) => {
    e.preventDefault();
    e.stopPropagation();
    toggleDock();
  }, { passive: false });

  dock.addEventListener("transitionend", () => invalidateMapBurst());
}

function selectPoi(id, fromMarker){
  const p = POIS.find(x => x.id === id);
  if(!p || !map || !targetMarker) return;

  openDock();

  const title = `${p.n}. ${p.name}`;
  const ll = [p.lat, p.lon];

  map.setView(ll, 17);
  targetMarker.setLatLng(ll);

  targetMarker
    .bindPopup(`<b>${escapeHtml(title)}</b>`)
    .openPopup();

  // ha markerb≈ël j√∂tt, m√°r nyitva a popup, ok
  invalidateMapBurst();
}

// gombokhoz kint a HTML-ben
function showOnMap(id){
  if(!map) initMap();
  selectPoi(id, false);
}
window.showOnMap = showOnMap;

document.addEventListener("DOMContentLoaded", () => {
  initMapDock();

  // t√©rk√©p inicializ√°l√°sa r√∂gt√∂n (hogy minden oldalon biztos legyen)
  // ha szeretn√©d csak nyit√°skor, ezt a sort ki lehet venni
  initMap();

  window.addEventListener("resize", () => invalidateMapBurst());
});
</script>

</body>
</html>
